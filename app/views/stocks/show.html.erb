<%= javascript_include_tag "stocks.coffee.js" %>
<%= include_gon(:init => true) %>


<% content_for :title do %>
  <title><%= @stock[:ticker_symbol] %> Stock Predictions - StockHero.com</title>
<% end %>

<div class = "constrainer">
  <div class = "main-aside col-sm-4">
    <div class = "stock-container">
      <div class = "row">
        <div class = "col-xs-4">
          <p class = "stock-ticker"><%= @stock[:ticker_symbol] %></p>
        </div>
        <div class = "col-xs-6">
          <p class = "stock-ticker-price"><%= @stock[:daily_stock_price] %></p>
          <p class = "stock-ticker-price">
              <font color="green" > +1.34 </font>
          </p>
        </div>
      </div>
      <div class = "row">
        <div class = "col-xs-4">
          <p class = "stock-ticker-detail-header">Predictions</p>
          <p class = "stock-ticker-detail-number"><%= @stock.predictions.count %></p>
        </div>
        <div class = "col-xs-4">
          <p class = "stock-ticker-detail-header">Comments</p>
          <p class = "stock-ticker-detail-number">38</p>
        </div>
      </div>
      <div class = "row">
        <div class = "col-xs-4">
          <p class = "stock-ticker-detail-header">P/E</p>
          <p class = "stock-ticker-detail-number">62.37M<br>64.13M</p>
        </div>
        <div class = "col-xs-4">
          <p class = "stock-ticker-detail-header">52wk</p>
          <p class = "stock-ticker-detail-number">67.77<br>103.74</p>
        </div>
        <div class = "col-xs-4">
          <p class = "stock-ticker-detail-header">Vol/ Avg</p>
          <p class = "stock-ticker-detail-number">28</p>
        </div>
      </div>
      <div class = "row">
        <div class = "col-xs-4">
          <p class = "stock-ticker-detail-header">Followers</p>
          <p class = "stock-ticker-detail-number" id = "followers"><%= @stock.followers.count %></p>
        </div>
          <%= render 'shared/follow_form'%>
      </div>
    </div>

<!-- PREDICTION FORM -->
    <div class = "stock-page-prediction-box">
      <% if @prediction.active_prediction_exists? %>
        <%= render @prediction %>
      <% else %>
        <%= render 'shared/prediction_form' %>
      <% end %>
    </div>

    <%= render 'shared/comment_form' %>

    <div class = "stock-page-top-analysts">

    
      <p class = "stock-page-top-analysts-header">
        Top <%= @stock[:ticker_symbol] %> Analysts
      </p>

      <a href = "#">
        <div class = "row">
          <div class = "col-sm-3">
            <div class = "top-analysts-mug-container">
              <img src="images/mug2.png">
            </div>
          </div>
          <div class = "top-analysts-txt-container col-xs-9">
            <p class = "top-analysts-handle">USER-NAME</p>
            <p class = "top-analysts-points">100 points</p>
          </div>
        </div>
      </a>

    </div>

  </div>


<!-- STOCK GRAPH -->

  <div class = "stock-page-aside col-sm-8">
    <div class = "graph-container">

    <div id="predictiondetailsbox" style="height:50px; width:auto;">
    </div>

    <div style="color:red">
      <ul id="response-box">
      </ul>
    </div>

      <div class = "graph-buttons" style="width:450px">
        <% @graph_buttons.each do |button| %>
          <button id="button"
              data-button-type=<%= button %>
              >
            <%= button %>
          </button>

        <% end %>
        
      </div>
      

      <div id="stock-div" style="min-width:50px;"></div>
    </div>

    <div class = "prediction-buttons-container">
      <div class = "row">
        <div class = "col-xs-6">
          <input type="submit" class="btn prediction-btn-stock-page" value="Make a Prediction">
        </div>
        <div class = "col-xs-6">
          <input type="submit" class="btn prediction-btn-stock-page" value="Make a Comment">
        </div>
      </div>
    </div>



    <!-- STREAM POSTS -->
    <div class = "stream" >
      <%= render partial: "streams/stream_main", locals: {streams: @streams, nest_count: 0} %>
    </div>
    <div id = "infinite-scrolling" >
      <%= will_paginate @streams %>
    </div>
    
  </div>
</div>





